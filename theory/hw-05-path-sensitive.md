# Теоретическое ДЗ №5: Чувствительные к пути анализы

### Вопрос №1:

Напишите вариант программы, для которой анализ открытости-закрытости файлов не показывает корректный результат даже с учётом всех возможных условий в переходах

### Ответ на вопрос №1:

В этой программе всё плохо, и даже dead-code elimination не помогает :(
```c#
main() {
    open();
    flag = 1;
    x = input();
    if (x > 10) {
        flag = 0;
        output(x);
        if (x > 20) {
            flag = 1;
            output(x);
        } else {
            close();
        }
    }
    if (flag) {
        close();
    }
}
```

Плохо всё из-за манипуляций с `flag`, усложняющих control-flow. Алгоритмически эти манипуляции верны, но каждому изменению `flag` не сопутствует вызов `open()` / `close()`.

### Вопрос №2:

Предложите, каким образом можно решить описанные в лекции проблемы в этой ситуации

### Ответ на вопрос №2:

Можно модифицировать рантайм нашего языка, чтобы `open()` был RAII: вызвали `close()` - значит выставили флажок, а когда придет время удалять дескриптор файла, созданный с помощью `open()`, то нужно вызвать `close()`, если флажок не выставлен.
